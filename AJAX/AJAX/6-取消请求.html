<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>取消请求</title>
    <script>
        window.onload = function () {
            var btns = document.getElementsByTagName('button');
            let xhr= null;

            //标识变量
            let isSending = false; //判断是否正在发送ajax请求
            //点击发送按钮
            btns[0].onclick = function () {
                //判断标识变量
                if(isSending)xhr.abort();
                xhr = new XMLHttpRequest();

                //修改 标识变量的值
                isSending = true;
                xhr.open('GET','http://127.0.0.1:8000/delay');
                xhr.send(); //发送
                xhr.onreadystatechange = function () {
                    if(xhr.readyState == 4){
                        //修改标识变量
                        isSending = false;
                    }
                }
            };

            //点击取消按钮
            btns[1].onclick = function () {
                xhr.abort();//阻止发送
            };
        };
    </script>
</head>
<body>
<button>点击发送</button>
<button>点击取消</button>
</body>
</html>
